<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with SWATplusR • SWATplusR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with SWATplusR">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SWATplusR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/SWATplusR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_par_sensitivity.html">01 - Parameter sensitivity analysis</a>
    </li>
    <li>
      <a href="../articles/02_par_sampl_calib.html">02 - Parameter sampling and model calibration</a>
    </li>
    <li>
      <a href="../articles/03_par_optim.html">03 - Parameter optimization</a>
    </li>
    <li>
      <a href="../articles/04_vis_example.html">04 - Visualization of simulation results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chrisschuerz/SWATplusR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting started with SWATplusR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/chrisschuerz/SWATplusR/blob/master/vignettes/SWATplusR.Rmd"><code>vignettes/SWATplusR.Rmd</code></a></small>
      <div class="hidden name"><code>SWATplusR.Rmd</code></div>

    </div>

    
    
<div id="loading-r-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-r-packages" class="anchor"></a>Loading R packages</h2>
<p>Before exploring the package load <code>SWATplusR</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(SWATplusR)</code></pre></div>
</div>
<div id="loading-demos" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-demos" class="anchor"></a>Loading demos</h2>
<p>The R package <code>SWATdata</code> provides a set of fast running, lightweight SWAT2012 and SWAT+ model setups of a head watershed of the Little River Experimental Watershed <span class="citation">(LREW; Bosch et al., <a href="#ref-Bosch2007">2007</a>)</span>. Additionally, discharge observations at the outlet of the demo catchment (Gauge J of LREW) and spatial information of the SWAT model setups are available from <code>SWATdata</code>. An overview of the available data sets is available on the <a href="https://github.com/chrisschuerz/SWATdata#swatdata-"><code>SWATdata</code></a> GitHub page.</p>
<div id="swat-projects" class="section level3">
<h3 class="hasAnchor">
<a href="#swat-projects" class="anchor"></a>SWAT projects</h3>
<p>The demo data that is available from <code>SWATdata</code> can be loaded with the function <code><a href="../reference/load_demo.html">load_demo()</a></code>. Loading an entire SWAT project to your hard drive requires the information that the loaded <code>dataset</code> is a <code>'project'</code>. As the project will be written to the hard drive a <code>path</code> is required. Further, the SWAT <code>version</code> must be provided, to either load a SWAT+ (<code>'plus'</code>), or a SWAT2012 (<code>'2012'</code>) project. Optionally, the <code>revision</code> number can be provided if a specific model revision (only for SWAT+) should be loaded. An overview of the different SWAT demo project setups (with their revision numbers) is available at the <a href="https://github.com/chrisschuerz/SWATdata#swatdata-"><code>SWATdata</code></a> GitHub page. If no revision number is provided, a project with the most recent revision number available fom <code>SWATdata</code> is loaded. A demo project can be loaded with the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The path where the SWAT demo project will be written</span>
demo_path &lt;-<span class="st"> "Define:/your/path"</span>

<span class="co"># Loading a SWAT+ demo project</span>
path_plus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"project"</span>,
                       <span class="dt">version =</span> <span class="st">"plus"</span>,
                       <span class="dt">path =</span> demo_path,
                       <span class="dt">revision =</span> <span class="dv">57</span>)

<span class="co"># Loading a SWAT2012 demo project</span>
path_<span class="dv">2012</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"project"</span>,
                       <span class="dt">version =</span> <span class="st">"2012"</span>,
                       <span class="dt">path =</span> demo_path)</code></pre></div>
<p>Here <code><a href="../reference/load_demo.html">load_demo()</a></code> loads a demo project data set and saves it in the defined <code>demo_path</code>. Additionally, the function returns the final demo project path (<code>path_plus</code> and <code>path_2012</code>) as a character string back to R. This path can be directly used to run the SWAT model located in that path.</p>
</div>
<div id="observation-data" class="section level3">
<h3 class="hasAnchor">
<a href="#observation-data" class="anchor"></a>Observation data</h3>
<p><code>SWATplusR</code> also provides observation data of daily discharge records at the main outlet of the demo catchment (Gauge J of LREW) for the time period 1968-01-01 until 2012-12-31. The data set is useful for the model evaluation of a demo project. You can load the observation data as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_obs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"observation"</span>)

q_obs
<span class="co">#&gt; # A tibble: 16,437 x 2</span>
<span class="co">#&gt;    date       discharge</span>
<span class="co">#&gt;    &lt;date&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt;  1 1968-01-01     0.16 </span>
<span class="co">#&gt;  2 1968-01-02     0.570</span>
<span class="co">#&gt;  3 1968-01-03     0.61 </span>
<span class="co">#&gt;  4 1968-01-04     0.37 </span>
<span class="co">#&gt;  5 1968-01-05     0.25 </span>
<span class="co">#&gt;  6 1968-01-06     0.2  </span>
<span class="co">#&gt;  7 1968-01-07     0.21 </span>
<span class="co">#&gt;  8 1968-01-08     0.22 </span>
<span class="co">#&gt;  9 1968-01-09     0.18 </span>
<span class="co">#&gt; 10 1968-01-10     0.34 </span>
<span class="co">#&gt; # … with 16,427 more rows</span></code></pre></div>
<p>A quick plot of the observation data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(q_obs, <span class="dt">type =</span> <span class="st">"l"</span>)</code></pre></div>
<p><img src="SWATplusR_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="spatial-data" class="section level3">
<h3 class="hasAnchor">
<a href="#spatial-data" class="anchor"></a>Spatial data</h3>
<p>To visualize simulation results spatially, shape files of the subbasins, river network, and HRUs for the SWAT+ and the SWAT2012 demo setups are available from <code>SWATplusR</code>. For spatial data <code><a href="../reference/load_demo.html">load_demo()</a></code> only returns the paths to the shape files. As the spatial data for the two SWAT project setups looks different loading the data requires the definition of the SWAT <code>version</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Path to the subbasin shape file</span>
sub_path &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"subbasin"</span>, <span class="dt">version =</span> <span class="st">"plus"</span>)
<span class="co"># Path to the subbasin shape file</span>
riv_path &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"river"</span>, <span class="dt">version =</span> <span class="st">"plus"</span>)

sub_path
<span class="co">#&gt; [1] "/home/christoph/R/x86_64-pc-linux-gnu-library/3.6/SWATdata/extdata/plus_shapes/sub.shp"</span></code></pre></div>
<p>These paths you can use to load the spatial data with your preferred method. The package <code>sf</code> <span class="citation">(Pebesma, <a href="#ref-Pebesma2018a">2018</a>; Pebesma et al., <a href="#ref-Pebesma2018b">2018</a>)</span> provides a very elegant way to work with spatial vector objects in R that have a direct integration for plotting in <code>ggplot2</code> <span class="citation">(Wickham, <a href="#ref-Wickham2016">2016</a>)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Loading the sf and ggplot2 packages for the visualization</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sf)
<span class="co">#&gt; Linking to GEOS 3.6.2, GDAL 2.2.3, PROJ 4.9.3</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="co">#&gt; Registered S3 methods overwritten by 'ggplot2':</span>
<span class="co">#&gt;   method         from </span>
<span class="co">#&gt;   [.quosures     rlang</span>
<span class="co">#&gt;   c.quosures     rlang</span>
<span class="co">#&gt;   print.quosures rlang</span>

<span class="co"># Loading the spatial data as simple features</span>
sub &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/st_read">read_sf</a></span>(sub_path)
riv &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/st_read">read_sf</a></span>(riv_path)

<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span>(<span class="dt">data =</span> sub) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span>(<span class="dt">data =</span> riv, <span class="dt">col =</span> <span class="st">"royalblue"</span>, <span class="dt">lwd =</span> <span class="fl">0.75</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf_label</a></span>(<span class="dt">data =</span> riv, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">label =</span> Channel)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</code></pre></div>
<p><img src="SWATplusR_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
<div id="first-swat-model-runs" class="section level2">
<h2 class="hasAnchor">
<a href="#first-swat-model-runs" class="anchor"></a>First SWAT model runs</h2>
<p>SWAT projects (e.g. one of the demo projects) can be executed from R with the functions <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code> to run a SWAT2012 project or <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> to run a SWAT+ project. The minimum requirements to execute a SWAT project are to provide the <code>project_path</code> to the project folder on the hard drive and to define the simulation outputs that the simulation should return to R. The definition of the simulation output always follows a simple pattern. An output variable that should be returned must be defined using the function <code><a href="../reference/define_output.html">define_output()</a></code>. Below is a simple example to run a SWAT+ project and return the <code>variable = 'flo_out'</code> that is written into the <code>file = 'channel'</code> file for the spatial <code>unit = 1</code>. <strong>Caution</strong> in the demo SWAT+ model setup the main channel is channel number 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_sim_plus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swatplus.html">run_swatplus</a></span>(<span class="dt">project_path =</span> path_plus,
                           <span class="dt">output =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"channel"</span>,
                                                  <span class="dt">variable =</span> <span class="st">"flo_out"</span>,
                                                  <span class="dt">unit =</span> <span class="dv">1</span>))

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 0S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 0S</span>
<span class="co">#&gt; Performing 1 simulation on 1 core:</span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 3S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 3S</span></code></pre></div>
<p>The syntax definition of simulations outputs applies to SWAT+ and SWAT2012. The only difference between the two models in the output definition is how to correctly address the output variables. The output files are organized in different ways in SWAT+ and SWAT2012. Below you find an example to extract the simulation outputs of discharge at all three subbasin outlets in the SWAT2012 demo setup:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_sim_<span class="dv">2012</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swat2012.html">run_swat2012</a></span>(<span class="dt">project_path =</span> path_<span class="dv">2012</span>,
                           <span class="dt">output =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"rch"</span>,
                                                  <span class="dt">variable =</span> <span class="st">"FLOW_OUT"</span>,
                                                  <span class="dt">unit =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swat2012_demo/.model_run':</span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 3S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 3S</span>
<span class="co">#&gt; Performing 1 simulation on 1 core:</span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 4S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 4S</span></code></pre></div>
<p>The discharge in SWAT2012 is written in to the file <em>“output.rch”</em>. The discharge leaving a subbasin is written in the column <em>“FLOW_OUT”</em>. The only additional difference in running a basic simulation with SWAT+ and SWAT2012 is the different function call (<code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> or <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code>).</p>
<p>You might have noticed, that running SWAT also provides information on the progress. This is very convenient for long simulation runs with many model evaluations. If you implement the SWAT function into other function calls the writing to the console can be an undesired behavior. You can quiet the function call with the argument <code>quiet = TRUE</code>.</p>
<div id="output-definition" class="section level3">
<h3 class="hasAnchor">
<a href="#output-definition" class="anchor"></a>Output definition</h3>
<p>The previous examples illustrated how to extract one <code>variable</code> (but maybe for several <code>units</code>) from the simulation outputs. To extract several variables you can simply combine them in a <code><a href="https://www.rdocumentation.org/packages/base/topics/list">list()</a></code>. In the example below we extract several water balance components of the SWAT+ demo simulations. Aggregated variables for a SWAT+ simulation are written to the <em>‘basin_wb’</em> file and there is only one spatial unit (the entire basin) written to that file. Therefore, the <code>unit</code> must be 1. Values different from 1 will not return any simulation results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wb_sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swatplus.html">run_swatplus</a></span>(<span class="dt">project_path =</span> path_plus,
           <span class="dt">output =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">precip =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                <span class="dt">variable =</span> <span class="st">"precip"</span>,
                                                <span class="dt">unit =</span> <span class="dv">1</span>),
                         <span class="dt">q_sur  =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                <span class="dt">variable =</span> <span class="st">"surq_gen"</span>,
                                                <span class="dt">unit =</span> <span class="dv">1</span>),
                         <span class="dt">q_lat  =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                <span class="dt">variable =</span> <span class="st">"latq"</span>,
                                                <span class="dt">unit =</span> <span class="dv">1</span>),
                         <span class="dt">eta    =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                <span class="dt">variable =</span> <span class="st">"et"</span>,
                                                <span class="dt">unit =</span> <span class="dv">1</span>)))

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 1S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 1S</span>
<span class="co">#&gt; Performing 1 simulation on 1 core:</span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 2S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 2S</span></code></pre></div>
<p>The output definition in a list has the additional advantage to optionally assign individual names to the variables (e.g. <code><a href="https://www.rdocumentation.org/packages/base/topics/list">list(name_a = define_output(...))</a></code>). The variables are returned in the output with that name in R then.</p>
</div>
<div id="exploring-a-simulation" class="section level3">
<h3 class="hasAnchor">
<a href="#exploring-a-simulation" class="anchor"></a>Exploring a simulation</h3>
<p>The goal of <code>SWATplusR</code> is to return the SWAT simulations in a <em>tidy</em> format. The simulation results look slightly different if only one simulation was performed, parameters were modified in a run, or multiple parameter sets were used to perform a large number of model evaluations. In general the outputs follow a general structure.</p>
<p>If only one simulation was performed, where no model parameters were modified, <code>run_swat*()</code> returns a <code>tibble</code> <span class="citation">(Müller and Wickham, <a href="#ref-Mueller2019">2019</a>)</span> with a <code>date</code> column and the columns with the simulated values of the extracted variables. The output table of the simulated water balance components has a date column and columns with the four extracted water balance components. The variable names are the individual names that we defined in the output definition:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wb_sim
<span class="co">#&gt; # A tibble: 3,653 x 5</span>
<span class="co">#&gt;    date       precip q_sur q_lat   eta</span>
<span class="co">#&gt;    &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2003-01-01  4.28  0.144 2.28  0.425</span>
<span class="co">#&gt;  2 2003-01-02  0.387 0.021 1.68  0.951</span>
<span class="co">#&gt;  3 2003-01-03  0     0.005 1.34  0.081</span>
<span class="co">#&gt;  4 2003-01-04  0     0.001 1.15  0.742</span>
<span class="co">#&gt;  5 2003-01-05  0     0     1.03  0.7  </span>
<span class="co">#&gt;  6 2003-01-06  0     0     0.962 0.676</span>
<span class="co">#&gt;  7 2003-01-07  0     0     0.912 0.574</span>
<span class="co">#&gt;  8 2003-01-08  0     0     0.874 0.628</span>
<span class="co">#&gt;  9 2003-01-09  0     0     0.844 0.716</span>
<span class="co">#&gt; 10 2003-01-10  0     0     0.817 0.423</span>
<span class="co">#&gt; # … with 3,643 more rows</span></code></pre></div>
<p>In case no variable name is assigned in the output definition (as in the simulations of the discharge above), the variable name of the extracted variable is used as the variable name. When several units are defined in <code><a href="../reference/define_output.html">define_output()</a></code> (e.g. in the example above <code>unit = 1:3</code>) a column in the output table is created for each unit and the unit number is added to the variable name. This is the case for the the simulation of <em>‘FLOW_OUT’</em> in the example above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_sim_<span class="dv">2012</span>
<span class="co">#&gt; # A tibble: 3,653 x 4</span>
<span class="co">#&gt;    date       FLOW_OUT_1 FLOW_OUT_2 FLOW_OUT_3</span>
<span class="co">#&gt;    &lt;date&gt;          &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2003-01-01      0.174     0.103       0.413</span>
<span class="co">#&gt;  2 2003-01-02      0.154     0.0956      0.377</span>
<span class="co">#&gt;  3 2003-01-03      0.150     0.0935      0.369</span>
<span class="co">#&gt;  4 2003-01-04      0.148     0.0921      0.363</span>
<span class="co">#&gt;  5 2003-01-05      0.146     0.0912      0.359</span>
<span class="co">#&gt;  6 2003-01-06      0.145     0.0906      0.357</span>
<span class="co">#&gt;  7 2003-01-07      0.144     0.0901      0.355</span>
<span class="co">#&gt;  8 2003-01-08      0.144     0.0897      0.354</span>
<span class="co">#&gt;  9 2003-01-09      0.143     0.0894      0.353</span>
<span class="co">#&gt; 10 2003-01-10      0.143     0.0890      0.352</span>
<span class="co">#&gt; # … with 3,643 more rows</span></code></pre></div>
<p>The <em>tidy</em> writing of the simulation results allows an easy processing of the data in the analysis workflow in R. Here is a quick example how to ‘wrangle’ the simulated discharge data with <code>dplyr</code> <span class="citation">(Wickham et al., <a href="#ref-Wickham2019">2019</a>)</span> and <code>tidyr</code> <span class="citation">(Wickham and Henry, <a href="#ref-Wickham2018a">2018</a>)</span> and plotting it with <code>ggplot2</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

q_plot &lt;-<span class="st"> </span>q_sim_<span class="dv">2012</span> <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(date, FLOW_OUT_<span class="dv">3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">q_sim =</span> FLOW_OUT_<span class="dv">3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(., q_obs, <span class="dt">by =</span> <span class="st">"date"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">q_obs =</span> discharge) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(., <span class="dt">key =</span> <span class="st">"variable"</span>, <span class="dt">value =</span> <span class="st">"discharge"</span>, <span class="op">-</span>date)

<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> q_plot) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> date, <span class="dt">y =</span> discharge, <span class="dt">col =</span> variable, <span class="dt">lty =</span> variable)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"black"</span>, <span class="st">"tomato3"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</code></pre></div>
<p><img src="SWATplusR_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
</div>
<div id="model-parameter-alteration" class="section level2">
<h2 class="hasAnchor">
<a href="#model-parameter-alteration" class="anchor"></a>Model parameter alteration</h2>
<p>The capability to alter model parameters in a SWAT simulation is an essential option in <code>SWATplusR</code>. Model parameters can be modified in a SWAT simulation by passing the respective parameters with the argument <code>parameter</code> in <code>run_swat*()</code>. A single parameter set can be provided as a vector. Many parameter sets that should be used in simulations have to be provided in a <code>tibble</code>.</p>
<p>To modify a model parameter information on the type of change (relative, absolute change etc.), the extent of the change (e.g. all or selected subbasins/land uses/ soil types etc.) and the magnitude of change are required. In <code>SWATplusR</code> most of that information is passed with the variable name. Thus, the variable names use a very specific syntax. A parameter name can consist of several parts, where some are required and others are optional. The minimum requirements for the elements of a parameter name are the actual name of the parameter in the model an the type of change. Options for the type of change are <em>‘relchg’</em> and <em>‘pctchg’</em> to alter a parameter by a fraction or a percentage of the initial parameter value, <em>“abschg”</em> to add an absolute value to the initial parameter value, or <em>“absval”</em> to replace a parameter by an absolute value. In the example below the parameter curve number (‘cn2’) that is defined on HRU level will be increased by the absolute value 5 in all HRUs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">par_mod &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"cn2.hru|change = abschg"</span> =<span class="st"> </span><span class="dv">5</span>)</code></pre></div>
<p>Many options to constrain a parameter change are available in <code>SWATplusR</code> (<em>in the current version of <code>SWATplusR</code> only for SWAT2012</em>). Constraints for the alteration of a parameter is added with a ‘|’ and a logical expression. Below you find an example for the change of the curve number ‘CN2’ in a SWAT2012 setup, that is only effective for the subbasins 1 to 5 and only for the land uses “WWHT” and “CORN”. Also take care that ‘CN2’ is a parameter of the ‘.mgt’ input file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">par_mod &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"CN2.mgt|change = abschg | sub == 1:5 | luse %in% c('WWHT', 'CORN') "</span> =<span class="st"> </span><span class="dv">5</span>)</code></pre></div>
<p>Individual parameter names can be assigned with the <code>::</code> operator. At the beginning of a parameter definition the individual parameter name is provided followed by ‘::’ and the actual parameter definition:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">par_mod &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"my_name::cn2.hru|change = abschg"</span> =<span class="st"> </span><span class="dv">5</span>)</code></pre></div>
<div id="simulation-with-a-single-parameter-set" class="section level3">
<h3 class="hasAnchor">
<a href="#simulation-with-a-single-parameter-set" class="anchor"></a>Simulation with a single parameter set</h3>
<p>To define single parameter set a named vector is generated. The names define the parameters the type of change. Below a single parameter set is generated where all ‘cn2’ values in a SWAT+ model setup are reduced by 5 percent and the ‘alpha.gw’ value was set to 0.5 globally.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">par_single &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"cn2.hru|change = pctchg"</span> =<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="dv">5</span>,
                <span class="st">"alpha.gw|change = absval"</span> =<span class="st"> </span><span class="fl">0.5</span>)</code></pre></div>
<p>To include the parameter changes in the SWAT+ model execution the defined vector is simply passed with the argument <code>parameter</code> in the <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> function call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swatplus.html">run_swatplus</a></span>(<span class="dt">project_path =</span> path_plus,
                      <span class="dt">output =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"channel"</span>,
                                             <span class="dt">variable =</span> <span class="st">"flo_out"</span>,
                                             <span class="dt">unit =</span> <span class="dv">1</span>),
                      <span class="dt">parameter =</span> par_single)

<span class="co">#&gt; Building 1 thread in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Thread 1 of 1   Time elapsed: 1S   Time remaining: 0S    </span>
<span class="co">#&gt;  Completed 1 thread in 1S</span>
<span class="co">#&gt; Performing 1 simulation on 1 core:</span>
<span class="co">#&gt;  Simulation 1 of 1   Time elapsed: 2S   Time remaining: 0S</span>
<span class="co">#&gt;  Completed 1 simulation in 2S</span></code></pre></div>
</div>
<div id="simulations-with-many-parameter-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#simulations-with-many-parameter-sets" class="anchor"></a>Simulations with many parameter sets</h3>
<p>The same workflow works with several parameter sets when they are defined in a <code>tibble</code>. The example below uses the same parameters as above, but in this case a <code>tibble</code> was defined with 8 random realizations for each parameter within the defined boundaries.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">par_set &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(<span class="st">"cn2.hru|change = abschg"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">8</span>,<span class="op">-</span><span class="dv">15</span>,<span class="dv">10</span>),
                  <span class="st">"alpha.gw|change = absval"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">1</span>))
par_set</code></pre></div>
<p>The implementation in the <code>run_swat*()</code> function works the same way. To execute multiple SWAT simulations with many parameter sets the <code>SWATplusR</code> package provides an option parallel computing. To perform a parallel model execution the number of parallel threads is defined with the input argument <code>n_thread</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swatplus.html">run_swatplus</a></span>(<span class="dt">project_path =</span> path_plus,
                      <span class="dt">output =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">q_sur  =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                           <span class="dt">variable =</span> <span class="st">"surq_gen"</span>,
                                                           <span class="dt">unit =</span> <span class="dv">1</span>),
                                    <span class="dt">q_lat  =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                           <span class="dt">variable =</span> <span class="st">"latq"</span>,
                                                           <span class="dt">unit =</span> <span class="dv">1</span>)),
                      <span class="dt">parameter =</span> par_set,
                      <span class="dt">n_thread =</span> <span class="dv">4</span>)

<span class="co">#&gt; Building 4 threads in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Thread 2 of 4   Time elapsed: 1S   Time remaining: 1S    </span>
<span class="co">#&gt;  Completed 4 thread in 2S</span>
<span class="co">#&gt; Performing 8 simulations on 4 cores:</span>
<span class="co">#&gt;  Simulation 4 of 8   Time elapsed: 4S   Time remaining: 4S</span>
<span class="co">#&gt;  Completed 8 simulations in 11S</span></code></pre></div>
</div>
<div id="exploring-simulations-with-parameter-alterations" class="section level3">
<h3 class="hasAnchor">
<a href="#exploring-simulations-with-parameter-alterations" class="anchor"></a>Exploring simulations with parameter alterations</h3>
<p>When parameters were altered in a simulation run, the performed parameter changes are saved in the simulation outputs by default. As a consequence, the entire simulation output cannot be provided in a single <code>tibble</code> anymore and will be returned as a list with two main list entries. <code>output$parameter</code> provides all information on the parameter changes that were performed in the simulation runs. <code>output$simulation</code> provides the simulation results. The outputs of the previous model execution of the SWAT+ demo project has the following structure</p>
<p>The list entry <code>$parameter</code> holds two <code>tibbles</code>. The first <code>tibble</code> shows the values of the parameter changes of each model evaluation that was performed with <code>run_swat*()</code>. Each row of the <code>tibble</code> represents a parameter set that was used in a model run. The second <code>tibble</code> provides information on the parameter names, their actual names in the model, the type of change and the constraints on the parameter:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_sim<span class="op">$</span>parameter
<span class="co">#&gt; $values</span>
<span class="co">#&gt; # A tibble: 8 x 2</span>
<span class="co">#&gt;        cn2 alpha</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.360  0.401</span>
<span class="co">#&gt; 2 -11.3    0.151</span>
<span class="co">#&gt; 3 -11.1    0.752</span>
<span class="co">#&gt; 4  -5.67   0.608</span>
<span class="co">#&gt; 5  -9.94   0.590</span>
<span class="co">#&gt; 6   8.37   0.571</span>
<span class="co">#&gt; 7   4.52   0.408</span>
<span class="co">#&gt; 8   0.0230 0.115</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $definition</span>
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   par_name parameter file_name change</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt; </span>
<span class="co">#&gt; 1 cn2      cn2       hru       abschg</span>
<span class="co">#&gt; 2 alpha    alpha     gw        absval</span></code></pre></div>
<p>The list entry <code>$simulation</code> provides the simulation runs that corresponds to each parameter set. Different to the single simulation without parameter changes is that now the simulated variables are not saved in a single <code>tibble</code>, but as a <code>list</code> of <code>tibbles</code>. In this case each simulated variable is saved in one <code>tibble</code>, where the first column of each <code>tibble</code> is the ‘date’ and the other columns are the individual simulation runs. Now the tibbles are named by the variables and each individual run saved in the tibbles is named ‘run_1’ to run ‘run_n’. In the example two variables were simulated, <code>q_out$simulation$q_sur</code> and <code>q_out$simulation$q_lat</code>. Each <code>tibble</code> holds the date and the runs 1 to 8:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_sim<span class="op">$</span>simulation
<span class="co">#&gt; $q_sur</span>
<span class="co">#&gt; # A tibble: 3,653 x 9</span>
<span class="co">#&gt;    date       run_1 run_2 run_3 run_4 run_5 run_6 run_7 run_8</span>
<span class="co">#&gt;    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2003-01-01 0.149 0.023 0.024 0.059 0.029 0.335 0.221 0.144</span>
<span class="co">#&gt;  2 2003-01-02 0.022 0.003 0.003 0.009 0.004 0.053 0.035 0.021</span>
<span class="co">#&gt;  3 2003-01-03 0.005 0.001 0.001 0.002 0.001 0.013 0.008 0.005</span>
<span class="co">#&gt;  4 2003-01-04 0.001 0     0     0.001 0     0.003 0.002 0.001</span>
<span class="co">#&gt;  5 2003-01-05 0     0     0     0     0     0.001 0.001 0    </span>
<span class="co">#&gt;  6 2003-01-06 0     0     0     0     0     0     0     0    </span>
<span class="co">#&gt;  7 2003-01-07 0     0     0     0     0     0     0     0    </span>
<span class="co">#&gt;  8 2003-01-08 0     0     0     0     0     0     0     0    </span>
<span class="co">#&gt;  9 2003-01-09 0     0     0     0     0     0     0     0    </span>
<span class="co">#&gt; 10 2003-01-10 0     0     0     0     0     0     0     0    </span>
<span class="co">#&gt; # … with 3,643 more rows</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $q_lat</span>
<span class="co">#&gt; # A tibble: 3,653 x 9</span>
<span class="co">#&gt;    date       run_1 run_2 run_3 run_4 run_5 run_6 run_7 run_8</span>
<span class="co">#&gt;    &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2003-01-01 2.27  2.52  2.52  2.44  2.51  1.81  2.06  2.28 </span>
<span class="co">#&gt;  2 2003-01-02 1.67  1.9   1.90  1.82  1.89  1.32  1.51  1.68 </span>
<span class="co">#&gt;  3 2003-01-03 1.34  1.54  1.54  1.47  1.53  1.05  1.21  1.34 </span>
<span class="co">#&gt;  4 2003-01-04 1.14  1.32  1.32  1.26  1.31  0.894 1.03  1.15 </span>
<span class="co">#&gt;  5 2003-01-05 1.03  1.19  1.19  1.13  1.18  0.802 0.931 1.03 </span>
<span class="co">#&gt;  6 2003-01-06 0.956 1.10  1.10  1.05  1.10  0.744 0.866 0.961</span>
<span class="co">#&gt;  7 2003-01-07 0.906 1.04  1.04  0.994 1.03  0.704 0.822 0.911</span>
<span class="co">#&gt;  8 2003-01-08 0.869 0.995 0.994 0.952 0.988 0.675 0.788 0.874</span>
<span class="co">#&gt;  9 2003-01-09 0.838 0.957 0.956 0.917 0.95  0.651 0.761 0.843</span>
<span class="co">#&gt; 10 2003-01-10 0.812 0.925 0.925 0.888 0.919 0.63  0.737 0.817</span>
<span class="co">#&gt; # … with 3,643 more rows</span></code></pre></div>
</div>
</div>
<div id="saving-and-loading-simulations" class="section level2">
<h2 class="hasAnchor">
<a href="#saving-and-loading-simulations" class="anchor"></a>Saving and loading Simulations</h2>
<p>In many cases it is advantageous to save the simulations incrementally after each model evaluation, for instance when long simulation runs would be lost if the computer or the R instance crashes, or when the simulation results cannot be stored in the RAM storage at all.</p>
<p>Simulations can be saved incrementally in an <em>SQLite</em> data base on the local hard drive, by passing a name for the save folder with the argument <code>save_file</code> in <code>run_swat*()</code>. By default the data base with the name <code>save_file</code> is saved in the project folder. An individual path for the <code>save_file</code> can be defined with the argument <code>save_path</code>. In case the simulations should be only saved in the data base and not returned back to R, the argument <code>return_output = FALSE</code> has to be set.</p>
<p>These arguments are simply added to the <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> function call to save the simulations in a data base instead of returning them back to R. Below the arguments are added to the previous simulation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/run_swatplus.html">run_swatplus</a></span>(<span class="dt">project_path =</span> path_plus,
            <span class="dt">output =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">q_sur  =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                                 <span class="dt">variable =</span> <span class="st">"surq_gen"</span>,
                                                 <span class="dt">unit =</span> <span class="dv">1</span>),
            <span class="dt">q_lat  =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"basin_wb"</span>,
                                   <span class="dt">variable =</span> <span class="st">"latq"</span>,
                                   <span class="dt">unit =</span> <span class="dv">1</span>)),
            <span class="dt">parameter =</span> par_set,
            <span class="dt">n_thread =</span> <span class="dv">4</span>,
            <span class="dt">save_file =</span> <span class="st">"q_sur_lat"</span>,
            <span class="dt">return_output =</span> <span class="ot">FALSE</span>)

<span class="co">#&gt; Building 4 threads in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Thread 2 of 4   Time elapsed: 1S   Time remaining: 1S    </span>
<span class="co">#&gt;  Completed 4 thread in 2S</span>
<span class="co">#&gt; Performing 8 simulations on 4 cores:</span>
<span class="co">#&gt;  Simulation 4 of 8   Time elapsed: 3S   Time remaining: 3S</span>
<span class="co">#&gt;  Completed 8 simulations in 8S</span></code></pre></div>
<p>You can see that the function did not return any results in R but generated a folder that we called “q_sur_lat” passed by the argument <code>save_file</code> in the project folder. That folder now contains several data bases. The first data base is called “par_dat.sqlite” and stores the parameter information and the date vector. Further, each of the parallel threads of the simulation generated a data base where each thread wrote the simulation results (This is necessary to avoid access conflicts when writing to data bases in parallel). The simulation data bases are always called “sim_thread_i.sqlite”, where “i” are the indexes of the individual threads (1 to 4 in this case).</p>
<p><code>SWATplusR</code> provides two options to access the saved simulations. Loading large data bases into the R environment can take a long time. If you only want to know the the content of saved simulations (e.g. to check the successful simulation runs after a crash) you can scan the saved runs with the function <code><a href="../reference/scan_swat_run.html">scan_swat_run()</a></code>. The function writes meta information on the saved SWAT simulations into the console. The function returns the following for our saved runs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set the path to the folder where the date bases were saved</span>
path_saved_q &lt;-<span class="st"> "Path:/to/the/folder/q_sur_lat"</span>

<span class="kw"><a href="../reference/scan_swat_run.html">scan_swat_run</a></span>(<span class="dt">save_dir =</span> path_saved_q)
<span class="co">#&gt; Simulation period:</span>
<span class="co">#&gt;  2003-01-01 to 2012-12-31</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; Simulated variables:</span>
<span class="co">#&gt; q_lat: runs 1 to 8</span>
<span class="co">#&gt; q_sur: runs 1 to 8</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; Parameter set:</span>
<span class="co">#&gt; # A tibble: 8 x 2</span>
<span class="co">#&gt;        cn2 alpha</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.360  0.401</span>
<span class="co">#&gt; 2 -11.3    0.151</span>
<span class="co">#&gt; 3 -11.1    0.752</span>
<span class="co">#&gt; 4  -5.67   0.608</span>
<span class="co">#&gt; 5  -9.94   0.590</span>
<span class="co">#&gt; 6   8.37   0.571</span>
<span class="co">#&gt; 7   4.52   0.408</span>
<span class="co">#&gt; 8   0.0230 0.115</span>
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   par_name parameter file_name change</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;</span>
<span class="co">#&gt; 1 cn2      cn2       hru       abschg</span>
<span class="co">#&gt; 2 alpha    alpha     gw        absval</span></code></pre></div>
<p><code><a href="../reference/scan_swat_run.html">scan_swat_run()</a></code> returns information on the simulation period, which output variables were saved and which simulation runs were executed for these variables. Further, information on the used model parameter sets is written.</p>
<p>With <code><a href="../reference/load_swat_run.html">load_swat_run()</a></code> you can then load the simulations saved in the data bases. In case the entire set of simulations cannot be loaded in to the RAM storage the function provides the option to only load parts of the saved simulations. In the example below for example we load only the variable “q_lat” and only the first three runs into R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_subset &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_swat_run.html">load_swat_run</a></span>(<span class="dt">save_dir =</span> path_saved_q,
                          <span class="dt">variable =</span> <span class="st">"q_lat"</span>,
                          <span class="dt">run =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_subset
<span class="co">#&gt; $parameter</span>
<span class="co">#&gt; $parameter$values</span>
<span class="co">#&gt; # A tibble: 8 x 2</span>
<span class="co">#&gt;        cn2 alpha</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.360  0.401</span>
<span class="co">#&gt; 2 -11.3    0.151</span>
<span class="co">#&gt; 3 -11.1    0.752</span>
<span class="co">#&gt; 4  -5.67   0.608</span>
<span class="co">#&gt; 5  -9.94   0.590</span>
<span class="co">#&gt; 6   8.37   0.571</span>
<span class="co">#&gt; 7   4.52   0.408</span>
<span class="co">#&gt; 8   0.0230 0.115</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameter$definition</span>
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   par_name parameter file_name change</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt; </span>
<span class="co">#&gt; 1 cn2      cn2       hru       abschg</span>
<span class="co">#&gt; 2 alpha    alpha     gw        absval</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $simulation</span>
<span class="co">#&gt; $simulation$q_lat</span>
<span class="co">#&gt; # A tibble: 3,653 x 4</span>
<span class="co">#&gt;    date                run_1 run_2 run_3</span>
<span class="co">#&gt;    &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2003-01-01 00:00:00 2.27  2.52  2.52 </span>
<span class="co">#&gt;  2 2003-01-02 00:00:00 1.67  1.9   1.90 </span>
<span class="co">#&gt;  3 2003-01-03 00:00:00 1.34  1.54  1.54 </span>
<span class="co">#&gt;  4 2003-01-04 00:00:00 1.14  1.32  1.32 </span>
<span class="co">#&gt;  5 2003-01-05 00:00:00 1.03  1.19  1.19 </span>
<span class="co">#&gt;  6 2003-01-06 00:00:00 0.956 1.10  1.10 </span>
<span class="co">#&gt;  7 2003-01-07 00:00:00 0.906 1.04  1.04 </span>
<span class="co">#&gt;  8 2003-01-08 00:00:00 0.869 0.995 0.994</span>
<span class="co">#&gt;  9 2003-01-09 00:00:00 0.838 0.957 0.956</span>
<span class="co">#&gt; 10 2003-01-10 00:00:00 0.812 0.925 0.925</span>
<span class="co">#&gt; # … with 3,643 more rows</span></code></pre></div>
</div>
<div id="further-swatplusr-input-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#further-swatplusr-input-arguments" class="anchor"></a>Further <code>SWATplusR</code> input arguments</h2>
<p>The functions <code><a href="../reference/run_swat2012.html">run_swat2012()</a></code> and <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code> have many further input arguments that allow to control important settings of a SWAT simulation. Here I will just mention a few of the essential ones. A detailed overview of the input arguments is provided in the respective function documentations. The simulation period can be controlled with the arguments <code>start_date</code> and <code>end_date</code>. The format writing the outputs of the simulations in the SWAT project folder is controlled by the arguments <code>output_interval</code> to define whether the simulations are written with daily, monthly or yearly time steps, <code>years_skip</code> to define the simulated years that should be skipped for writing the simulation outputs. With the argument <code>run_index</code> a subset of the provided parameter combinations can be simulated. This is useful, when for instance distributing the simulations on multiple computers, or when continuing the simulations after a crash.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Bosch2007">
<p>Bosch, D. D., Sheridan, J. M., Lowrance, R. R., Hubbard, R. K., Strickland, T. C., Feyereisen, G. W. and Sullivan, D. G.: Little river experimental watershed database, Water Resources Research, 43(9), doi:<a href="https://doi.org/10.1029/2006wr005844">10.1029/2006wr005844</a>, 2007.</p>
</div>
<div id="ref-Mueller2019">
<p>Müller, K. and Wickham, H.: Tibble: Simple data frames. [online] Available from: <a href="https://CRAN.R-project.org/package=tibble" class="uri">https://CRAN.R-project.org/package=tibble</a> (Accessed 5 March 2019), 2019.</p>
</div>
<div id="ref-Pebesma2018a">
<p>Pebesma, E.: Simple Features for R: Standardized Support for Spatial Vector Data, The R Journal, 10(1), 439–446, doi:<a href="https://doi.org/10.32614/RJ-2018-009">10.32614/RJ-2018-009</a>, 2018.</p>
</div>
<div id="ref-Pebesma2018b">
<p>Pebesma, E., Bivand, R., Racine, E., Sumner, M., Cook, I., Keitt, T., Lovelace, R., Wickham, H., Ooms, J., Müller, K. and Pedersen, T. L.: sf: Simple Features for R. [online] Available from: <a href="https://CRAN.R-project.org/package=sf" class="uri">https://CRAN.R-project.org/package=sf</a> (Accessed 5 March 2019), 2018.</p>
</div>
<div id="ref-Wickham2016">
<p>Wickham, H.: ggplot2: Elegant Graphics for Data Analysis, Springer-Verlag New York. [online] Available from: <a href="http://ggplot2.org" class="uri">http://ggplot2.org</a>, 2016.</p>
</div>
<div id="ref-Wickham2018a">
<p>Wickham, H. and Henry, L.: Tidyr: Easily tidy data with ’spread()’ and ’gather()’ functions. [online] Available from: <a href="https://CRAN.R-project.org/package=tidyr" class="uri">https://CRAN.R-project.org/package=tidyr</a> (Accessed 3 May 2019), 2018.</p>
</div>
<div id="ref-Wickham2019">
<p>Wickham, H., François, R., Henry, L. and Müller, K.: Dplyr: A grammar of data manipulation. [online] Available from: <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a> (Accessed 5 March 2019), 2019.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#loading-r-packages">Loading R packages</a></li>
      <li><a href="#loading-demos">Loading demos</a></li>
      <li><a href="#first-swat-model-runs">First SWAT model runs</a></li>
      <li><a href="#model-parameter-alteration">Model parameter alteration</a></li>
      <li><a href="#saving-and-loading-simulations">Saving and loading Simulations</a></li>
      <li><a href="#further-swatplusr-input-arguments">Further <code>SWATplusR</code> input arguments</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christoph Schuerz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
