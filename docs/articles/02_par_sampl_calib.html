<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>02 - Parameter sampling and model calibration • SWATplusR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="02 - Parameter sampling and model calibration">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SWATplusR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/SWATplusR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_par_sensitivity.html">01 - Parameter sensitivity analysis</a>
    </li>
    <li>
      <a href="../articles/02_par_sampl_calib.html">02 - Parameter sampling and model calibration</a>
    </li>
    <li>
      <a href="../articles/03_par_optim.html">03 - Parameter optimization</a>
    </li>
    <li>
      <a href="../articles/04_vis_example.html">04 - Visualization of simulation results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chrisschuerz/SWATplusR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>02 - Parameter sampling and model calibration</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/chrisschuerz/SWATplusR/blob/master/vignettes/02_par_sampl_calib.Rmd"><code>vignettes/02_par_sampl_calib.Rmd</code></a></small>
      <div class="hidden name"><code>02_par_sampl_calib.Rmd</code></div>

    </div>

    
    
<div id="r-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#r-packages" class="anchor"></a>R packages</h2>
<p>A common procedure in hydrological modeling is to draw random samples for a set of parameters, to execute the model with all drawn parameter combinations, evaluate the simulations based on one or several criteria, and select parameter sets that were able to reproduce the observation date sufficiently with the applied model setup. For R different routines are available to draw random samples. The simplest approach might be to use the function <code><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif()</a></code> from the base R package <code>stats</code> <span class="citation">(R Core Team, <a href="#ref-Rcore2019">2019</a>)</span> to draw uniform samples for each parameter. You can draw Latin Hypercube Samples [LHS] with the package <code>lhs</code> <span class="citation">(Carnell, <a href="#ref-Carnell2019">2019</a>)</span>. Other ‘pseudo’ and ‘quasi’ random numbers (that can be relevant for some methods for sensitivity analysis) can be drawn using the package <code>randtoolbox</code> <span class="citation">(Dutang C. and P., <a href="#ref-Dutang2018">2018</a>)</span>. In this example we will implement LHS sampling. To evaluate simulated time series of hydrological variables, multiple goodness-of-fit functions are available from literature. The <code>hydroGOF</code> package <span class="citation">(Mauricio Zambrano-Bigiarini, <a href="#ref-MZB2017">2017</a>)</span> summarizes frequently used functions for the evaluation of time series of hydrological variables.</p>
<div id="package-installation" class="section level3">
<h3 class="hasAnchor">
<a href="#package-installation" class="anchor"></a>Package installation</h3>
<p>If you do not have installed any of the required R package, follow the instructions for the respective R package. All of the required R packages are available from CRAN and can be installed with the following commands:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"lhs"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"hydroGOF"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"dplyr"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"lubridate"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"tibble"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"tidyr"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"purrr"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"ggplot2"</span>)</code></pre></div>
</div>
<div id="loading-r-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-r-packages" class="anchor"></a>Loading R packages</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(SWATplusR)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(lhs)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(hydroGOF)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(lubridate)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tibble)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(purrr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</code></pre></div>
</div>
</div>
<div id="loading-demo-data" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-demo-data" class="anchor"></a>Loading demo data</h2>
<p>The optimization example uses the SWAT+ demo project available from <code>SWATplusR</code>. The demo project is a very simple model setups of a head watershed of the Little River Experimental Watershed <span class="citation">(LREW; Bosch et al., <a href="#ref-Bosch2007">2007</a>)</span>. You can load the to your hard drive as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The path where the SWAT demo project will be written</span>
demo_path &lt;-<span class="st"> "Define:/your/path"</span>

<span class="co"># Loading the SWAT+ demo project on your hard drive</span>
path_plus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"project"</span>,
                       <span class="dt">version =</span> <span class="st">"plus"</span>,
                       <span class="dt">path =</span> demo_path, 
                       <span class="dt">revision =</span> <span class="dv">57</span>)</code></pre></div>
<p><code>SWATplusR</code> also provides observation data of daily discharge records at the main outlet of the demo for the time period 1968-01-01 until 2012-12-31. We will use the observation data to evaluate the model in each optimization step. For this example we define calibration and validation periods for our data set, where the calibration period is from 2003-01-01 to 2007-12-31 and the validation period ranges between 2008-01-01 and 2012-12-31. Therefore, we load the demo data and limit it to these time periods:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_obs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/load_demo.html">load_demo</a></span>(<span class="dt">dataset =</span> <span class="st">"observation"</span>)

q_obs_cal &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(q_obs, date <span class="op">&gt;=</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span>(<span class="st">"2003-01-01"</span>),
                           date <span class="op">&lt;=</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span>(<span class="st">"2007-12-31"</span>))

q_obs_val &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(q_obs, date <span class="op">&gt;=</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span>(<span class="st">"2008-01-01"</span>),
                           date <span class="op">&lt;=</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span>(<span class="st">"2012-12-31"</span>))</code></pre></div>
</div>
<div id="parameter-sampling" class="section level2">
<h2 class="hasAnchor">
<a href="#parameter-sampling" class="anchor"></a>Parameter sampling</h2>
<p>For the sampling example we will use 7 SWAT model parameters that are frequently calibrated for discharge. Below we create a <code>tibble</code> <span class="citation">(Müller and Wickham, <a href="#ref-Mueller2019">2019</a>)</span> that provides the parameter boundaries for the 7 parameters. We name the parameters using the specific syntax that is requested by the <code>run_swat*()</code> functions (see the <a href="https://chrisschuerz.github.io/SWATplusR/articles/SWATplusR.html#model-parameter-alteration">Get started</a> section on ‘Model parameter alteration’ to learn more on parameter names):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">par_bound &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(<span class="st">"cn2.hru | change = abschg"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">15</span>, <span class="dv">10</span>),
                    <span class="st">"lat_ttime.hru | change = absval"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.5</span>, <span class="dv">50</span>),
                    <span class="st">"lat_len.hru | change = absval"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">10</span>, <span class="dv">100</span>),
                    <span class="st">"k.sol | change = pctchg"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>),
                    <span class="st">"z.sol | change = pctchg"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>),
                    <span class="st">"esco.hru | change = absval"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>),
                    <span class="st">"epco.hru | change = absval"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>))</code></pre></div>
<div id="random-sampling-with-runif" class="section level3">
<h3 class="hasAnchor">
<a href="#random-sampling-with-runif" class="anchor"></a>Random sampling with <code><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif()</a></code>
</h3>
<p>The most basic way to draw random parameter samples is to use the base R function <code><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif()</a></code>. With <code><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif()</a></code> you can create a uniformly distributed vector. To draw a specific number of parameter sets with <code><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif()</a></code> you have to create a vector with that number of random values for each parameter and transform them to their parameter ranges. Below you find a very efficient approach to create a table of parameter combinations using a <code>map*()</code> function from the functional programing package <code>purrr</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_sample &lt;-<span class="st"> </span><span class="dv">250</span>
par_runif &lt;-<span class="st"> </span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span>(par_bound, <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(n_sample, .x[<span class="dv">1</span>], .x[<span class="dv">2</span>]))
par_runif
<span class="co">#&gt; # A tibble: 250 x 7</span>
<span class="co">#&gt;    `cn2.hru | chan… `lat_ttime.hru … `lat_len.hru | … `k.sol | change…</span>
<span class="co">#&gt;               &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1           -0.982            0.828             46.7             1.33</span>
<span class="co">#&gt;  2           -5.45             6.95              51.4           -14.8 </span>
<span class="co">#&gt;  3           -7.30            14.8               86.0           -23.4 </span>
<span class="co">#&gt;  4            1.95             7.21              12.4           -15.6 </span>
<span class="co">#&gt;  5           -2.82            13.0               36.6            47.0 </span>
<span class="co">#&gt;  6          -14.7              5.72              83.5           -41.2 </span>
<span class="co">#&gt;  7           -5.75            41.4               13.4           -25.4 </span>
<span class="co">#&gt;  8          -13.0             46.7               19.8           -31.3 </span>
<span class="co">#&gt;  9          -13.9             23.1               62.6           -44.3 </span>
<span class="co">#&gt; 10            0.174           33.3               29.8           -35.1 </span>
<span class="co">#&gt; # … with 240 more rows, and 3 more variables: `z.sol | change =</span>
<span class="co">#&gt; #   pctchg` &lt;dbl&gt;, `esco.hru | change = absval` &lt;dbl&gt;, `epco.hru | change</span>
<span class="co">#&gt; #   = absval` &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="random-sampling-with-lhs" class="section level3">
<h3 class="hasAnchor">
<a href="#random-sampling-with-lhs" class="anchor"></a>Random sampling with <code>lhs</code>
</h3>
<p>In a very similar way you can draw LHS samples using the function <code><a href="https://www.rdocumentation.org/packages/lhs/topics/randomLHS">randomLHS()</a></code> from the <code>lhs</code> package. Below you find an efficient example to draw a <code>n_sample = 250</code> LHS sampled parameter combinations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_sample &lt;-<span class="st"> </span><span class="dv">250</span>
n_par &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(par_bound)

par_iter1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/lhs/topics/randomLHS">randomLHS</a></span>(<span class="dt">n =</span> n_sample, <span class="dt">k =</span> n_par) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(., <span class="dt">.name_repair =</span> <span class="st">"minimal"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_df</a></span>(., par_bound, <span class="op">~</span><span class="st"> </span>(.x <span class="op">*</span><span class="st"> </span>(.y[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>.y[<span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span>.y[<span class="dv">1</span>])) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://purrr.tidyverse.org/reference/set_names.html">set_names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(par_bound))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">par_iter1
<span class="co">#&gt; # A tibble: 250 x 7</span>
<span class="co">#&gt;    `cn2.hru | chan… `lat_ttime.hru … `lat_len.hru | … `k.sol | change…</span>
<span class="co">#&gt;               &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1            0.423            49.5              48.4          -45.6  </span>
<span class="co">#&gt;  2            7.21             37.4              78.4          -44.8  </span>
<span class="co">#&gt;  3            9.11             38.9              90.3           46.0  </span>
<span class="co">#&gt;  4            0.582            21.6              86.8            0.268</span>
<span class="co">#&gt;  5           -9.75              3.84             84.8          -11.7  </span>
<span class="co">#&gt;  6           -4.20             28.7              80.3           19.4  </span>
<span class="co">#&gt;  7            9.45             17.7              62.5          -23.9  </span>
<span class="co">#&gt;  8           -8.93             21.8              74.3          -20.1  </span>
<span class="co">#&gt;  9            7.95              2.29             86.5           -2.96 </span>
<span class="co">#&gt; 10           -9.43             27.3              20.1          -42.6  </span>
<span class="co">#&gt; # … with 240 more rows, and 3 more variables: `z.sol | change =</span>
<span class="co">#&gt; #   pctchg` &lt;dbl&gt;, `esco.hru | change = absval` &lt;dbl&gt;, `epco.hru | change</span>
<span class="co">#&gt; #   = absval` &lt;dbl&gt;</span></code></pre></div>
</div>
</div>
<div id="model-calibration" class="section level2">
<h2 class="hasAnchor">
<a href="#model-calibration" class="anchor"></a>Model calibration</h2>
<div id="simulation-runs" class="section level3">
<h3 class="hasAnchor">
<a href="#simulation-runs" class="anchor"></a>Simulation runs</h3>
<p>In a next step we implement all LHS sampled parameter combinations in the SWAT+ demo setup and simulate daily discharges for the calibration period 2003-01-01 until 2007-12-31 (with a warm-up period of 3 years fro 2000 to 2002). To perform the simulations we pass the entire <code>tibble</code> with the parameter combinations with the argument <code>parameter</code> in the function <code><a href="../reference/run_swatplus.html">run_swatplus()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_cal1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swatplus.html">run_swatplus</a></span>(<span class="dt">project_path =</span> path_plus,
                       <span class="dt">output =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">q_sim =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"channel"</span>,
                                     <span class="dt">variable =</span> <span class="st">"flo_out"</span>,
                                     <span class="dt">unit =</span> <span class="dv">1</span>)),
                       <span class="dt">parameter =</span> par_iter1,
                       <span class="dt">start_date =</span> <span class="st">"2000-01-01"</span>,
                        <span class="dt">end_date =</span> <span class="st">"2007-12-31"</span>,
                       <span class="dt">years_skip =</span> <span class="dv">3</span>,
                       <span class="dt">n_thread =</span> <span class="dv">4</span>)

<span class="co">#&gt; Building 4 threads in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Completed 4 threads in 0S</span>
<span class="co">#&gt; Performing 250 simulations on 4 cores:</span>
<span class="co">#&gt;  Completed 250 simulations in 1M 54S</span></code></pre></div>
</div>
<div id="model-evaluation" class="section level3">
<h3 class="hasAnchor">
<a href="#model-evaluation" class="anchor"></a>Model evaluation</h3>
<p>We use the Nash Sutcliffe Efficiency criterion <span class="citation">(NSE; Nash and Sutcliffe, <a href="#ref-Nash1970">1970</a>)</span> to evaluate the simulations for the calibration period. The NSE is implemented in <code>hydroGOF</code> with the function <code><a href="https://www.rdocumentation.org/packages/hydroGOF/topics/NSE">NSE()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nse_cal1 &lt;-<span class="st"> </span>q_cal1<span class="op">$</span>simulation<span class="op">$</span>q_sim <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>date) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span>(., <span class="op">~</span><span class="kw"><a href="https://www.rdocumentation.org/packages/hydroGOF/topics/NSE">NSE</a></span>(.x<span class="op">/</span><span class="fl">8.64</span>, q_obs_cal<span class="op">$</span>discharge))</code></pre></div>
<p>The first iteration of discharge simulations and their evaluation with the NSE should help us to identify the relevant parameter and/or constrain parameter boundaries of parameters. Therefore we display the parameter samples with the resulting NSE values in dotty plots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dotty_cal1 &lt;-<span class="st"> </span>q_cal1<span class="op">$</span>parameter<span class="op">$</span>values <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">nse =</span> nse_cal1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(nse <span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="dv">5</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="dt">key =</span> <span class="st">"par"</span>, <span class="dt">value =</span> <span class="st">"parameter_range"</span>, <span class="op">-</span>nse)

<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> dotty_cal1) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> parameter_range, <span class="dt">y =</span> nse)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(.<span class="op">~</span>par, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">scales =</span> <span class="st">"free_x"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</code></pre></div>
<p><img src="02_par_sampl_calib_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>The only parameter that showed a clear parameter front in dotty plot is the “lat_ttime”. For the next iteration we will constrain the “lat_ttime” to the interval [0.5,5].</p>
</div>
<div id="parameter-update-and-re-evaluation-of-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#parameter-update-and-re-evaluation-of-the-model" class="anchor"></a>Parameter update and re-evaluation of the model</h3>
<p>To constrain the parameter “lat_ttime” we update the parameter boundaries table. As we only modify the boundaries of one parameter an efficient way is to do the following. In a next step we draw a new set of LHS sampled model parameter combinations and re-run the model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">par_bound<span class="op">$</span><span class="st">`</span><span class="dt">lat_ttime.hru | change = absval</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">5</span>)

par_cal2 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/lhs/topics/randomLHS">randomLHS</a></span>(<span class="dt">n =</span> n_sample, <span class="dt">k =</span> n_par) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(.) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_df</a></span>(., par_bound, <span class="op">~</span><span class="st"> </span>(.x <span class="op">*</span><span class="st"> </span>(.y[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>.y[<span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span>.y[<span class="dv">1</span>])) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://purrr.tidyverse.org/reference/set_names.html">set_names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(par_bound))

q_cal2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swatplus.html">run_swatplus</a></span>(<span class="dt">project_path =</span> path_plus,
                       <span class="dt">output =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">q_sim =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"channel"</span>,
                                     <span class="dt">variable =</span> <span class="st">"flo_out"</span>,
                                     <span class="dt">unit =</span> <span class="dv">1</span>)),
                       <span class="dt">parameter =</span> par_iter2,
                       <span class="dt">start_date =</span> <span class="st">"2000-01-01"</span>,
                        <span class="dt">end_date =</span> <span class="st">"2007-12-31"</span>,
                       <span class="dt">years_skip =</span> <span class="dv">3</span>,
                       <span class="dt">n_thread =</span> <span class="dv">4</span>)

<span class="co">#&gt; Building 4 threads in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Completed 4 threads in 0S</span>
<span class="co">#&gt; Performing 250 simulations on 4 cores:</span>
<span class="co">#&gt;  Completed 250 simulations in 1M 56S</span></code></pre></div>
<p>The updated simulations are again evaluated:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nse_cal2 &lt;-<span class="st"> </span>q_cal2<span class="op">$</span>simulation<span class="op">$</span>q_sim <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>date) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span>(., <span class="op">~</span><span class="kw"><a href="https://www.rdocumentation.org/packages/hydroGOF/topics/NSE">NSE</a></span>(.x<span class="op">/</span><span class="fl">8.64</span>, q_obs_cal<span class="op">$</span>discharge))</code></pre></div>
<p>To get an overview of the NSE values for the best simulation runs simply run the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(nse_cal2, <span class="dt">decreasing =</span> T) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span>()
<span class="co">#&gt; # A tibble: 250 x 2</span>
<span class="co">#&gt;    name    value</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 run_001 0.764</span>
<span class="co">#&gt;  2 run_137 0.751</span>
<span class="co">#&gt;  3 run_024 0.746</span>
<span class="co">#&gt;  4 run_038 0.745</span>
<span class="co">#&gt;  5 run_203 0.741</span>
<span class="co">#&gt;  6 run_078 0.739</span>
<span class="co">#&gt;  7 run_124 0.737</span>
<span class="co">#&gt;  8 run_149 0.735</span>
<span class="co">#&gt;  9 run_073 0.730</span>
<span class="co">#&gt; 10 run_241 0.729</span>
<span class="co">#&gt; # … with 240 more rows</span></code></pre></div>
<p>In our example we consider all simulations that resulted in an NSE &gt; 0.7 as acceptable simulation results. Therefore we select the acceptable simulations and their respective parameter combinations from our simulation outputs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">run_sel &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(nse_cal2 <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.7</span>)</code></pre></div>
<p>In total 44 simulations resulted in acceptable representations of the observed discharge.</p>
</div>
</div>
<div id="model-validation" class="section level2">
<h2 class="hasAnchor">
<a href="#model-validation" class="anchor"></a>Model validation</h2>
<div id="parameter-sampling-and-simulation" class="section level3">
<h3 class="hasAnchor">
<a href="#parameter-sampling-and-simulation" class="anchor"></a>Parameter sampling and simulation</h3>
<p>We will validate the selected 4299 parameter combinations in the validation period 2008-01-01 to 2012-12-31. Therefore, we use the indices of the acceptable simulations for the calibration period and use their parameter combinations to perform the simulations in the validation period:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q_val &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_swatplus.html">run_swatplus</a></span>(<span class="dt">project_path =</span> path_plus,
                      <span class="dt">output =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">q_sim =</span> <span class="kw"><a href="../reference/define_output.html">define_output</a></span>(<span class="dt">file =</span> <span class="st">"channel"</span>,
                                    <span class="dt">variable =</span> <span class="st">"flo_out"</span>,
                                    <span class="dt">unit =</span> <span class="dv">1</span>)),
                      <span class="dt">parameter =</span> q_cal2<span class="op">$</span>parameter,
                      <span class="dt">run_index =</span> run_sel,
                      <span class="dt">start_date =</span> <span class="st">"2005-01-01"</span>,
                       <span class="dt">end_date =</span> <span class="st">"2012-12-31"</span>,
                      <span class="dt">years_skip =</span> <span class="dv">3</span>,
                      <span class="dt">n_thread =</span> <span class="dv">4</span>, <span class="dt">keep_folder =</span> T)

<span class="co">#&gt; Building 4 threads in 'Define:/your/path/swatplus_demo/.model_run':</span>
<span class="co">#&gt;  Completed 4 threads in 0S</span>
<span class="co">#&gt; Performing 44 simulations on 4 cores:</span>
<span class="co">#&gt;  Completed 44 simulations in 20S</span></code></pre></div>
</div>
<div id="evaluation-of-the-calibration-period" class="section level3">
<h3 class="hasAnchor">
<a href="#evaluation-of-the-calibration-period" class="anchor"></a>Evaluation of the calibration period</h3>
<p>The evaluation of the validation period is identical to the evaluation of the iterations of the calibration period. To get an overview of the model performance in the validation period we visualize a summary statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nse_val &lt;-<span class="st"> </span>q_val<span class="op">$</span>simulation<span class="op">$</span>q_sim <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>date) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span>(., <span class="op">~</span><span class="kw"><a href="https://www.rdocumentation.org/packages/hydroGOF/topics/NSE">NSE</a></span>(.x<span class="op">/</span><span class="fl">8.64</span>, q_obs_val<span class="op">$</span>discharge))

nse_comp &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(<span class="dt">run =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(nse_cal2[run_sel]),
                   <span class="dt">calibration =</span> nse_cal2[run_sel],
                   <span class="dt">validation =</span> nse_val)

nse_comp <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="dt">key =</span> <span class="st">"period"</span>, <span class="dt">value =</span> <span class="st">"nse"</span>, <span class="op">-</span><span class="st"> </span>run) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> .) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> period, <span class="dt">y =</span> nse), <span class="dt">fill =</span> <span class="st">"grey"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</code></pre></div>
<p><img src="02_par_sampl_calib_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>A tabular overview can show a direct comparison of the simulations in the calibration and validation period for the individual runs and their parametrizations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nse_comp <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(calibration))
<span class="co">#&gt; # A tibble: 44 x 3</span>
<span class="co">#&gt;    run     calibration validation</span>
<span class="co">#&gt;    &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1 run_001       0.764      0.746</span>
<span class="co">#&gt;  2 run_137       0.751      0.713</span>
<span class="co">#&gt;  3 run_024       0.746      0.689</span>
<span class="co">#&gt;  4 run_038       0.745      0.707</span>
<span class="co">#&gt;  5 run_203       0.741      0.744</span>
<span class="co">#&gt;  6 run_078       0.739      0.706</span>
<span class="co">#&gt;  7 run_124       0.737      0.645</span>
<span class="co">#&gt;  8 run_149       0.735      0.724</span>
<span class="co">#&gt;  9 run_073       0.730      0.699</span>
<span class="co">#&gt; 10 run_241       0.729      0.698</span>
<span class="co">#&gt; # … with 34 more rows</span></code></pre></div>
</div>
</div>
<div id="visualization-of-discharge-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#visualization-of-discharge-simulation" class="anchor"></a>Visualization of discharge simulation</h2>
<p>We will plot the ensemble of simulations as a band of minimum and maximum values for each time step and compare it to the observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">run_best &lt;-<span class="st"> </span>nse_comp<span class="op">$</span>run[<span class="dv">1</span>]

get_run_stat &lt;-<span class="st"> </span><span class="cf">function</span>(run_table, best_run) {
  run_table <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>date) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">q_max =</span> <span class="kw"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap_dbl</a></span>(., max),
           <span class="dt">q_min =</span> <span class="kw"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap_dbl</a></span>(., min)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">matches</a></span>(best_run), q_min, q_max) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://purrr.tidyverse.org/reference/set_names.html">set_names</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"q_sim"</span>, <span class="st">"q_min"</span>, <span class="st">"q_max"</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span>(<span class="dt">date =</span> run_table<span class="op">$</span>date, <span class="dt">.before =</span> <span class="dv">1</span>)
}

cal_stat &lt;-<span class="st"> </span>q_cal2<span class="op">$</span>simulation<span class="op">$</span>q_sim <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">!!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(q_val<span class="op">$</span>simulation<span class="op">$</span>q_sim)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">get_run_stat</span>(., run_best) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span>(., is.numeric, <span class="op">~</span><span class="st"> </span>(.<span class="op">/</span><span class="fl">8.64</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">period =</span> <span class="st">"calibration"</span>)

val_stat &lt;-<span class="st"> </span>q_val<span class="op">$</span>simulation<span class="op">$</span>q_sim <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">get_run_stat</span>(., run_best) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span>(., is.numeric, <span class="op">~</span><span class="st"> </span>(.<span class="op">/</span><span class="fl">8.64</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">period =</span> <span class="st">"validation"</span>)

sim_stat &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(cal_stat, val_stat) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(., q_obs, <span class="dt">by =</span> <span class="st">"date"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>( <span class="dt">q_obs =</span> discharge) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="dt">key =</span> <span class="st">"variable"</span>, <span class="dt">value =</span> <span class="st">"q"</span>, <span class="op">-</span>date, <span class="op">-</span>q_min, <span class="op">-</span><span class="st"> </span>q_max, <span class="op">-</span>period)

<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> sim_stat) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> date, <span class="dt">ymin =</span> q_min, <span class="dt">ymax =</span> q_max), <span class="dt">fill =</span> <span class="st">"grey50"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> date, <span class="dt">y =</span> q, <span class="dt">col =</span> variable), <span class="dt">lwd =</span> <span class="fl">0.25</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"black"</span>, <span class="st">"tomato3"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>( <span class="dt">x =</span> <span class="st">"Date (yyyy)"</span>, 
        <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span> (Discharge<span class="op">~</span>(m<span class="op">^</span><span class="dv">3</span><span class="op">~</span>s<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})), 
        <span class="dt">col =</span> <span class="st">"Discharge"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(period<span class="op">~</span>., <span class="dt">scales =</span> <span class="st">"free_x"</span>, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">panel.spacing =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(<span class="fl">0.2</span>, <span class="st">"lines"</span>),
        <span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</code></pre></div>
<p><img src="02_par_sampl_calib_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Bosch2007">
<p>Bosch, D. D., Sheridan, J. M., Lowrance, R. R., Hubbard, R. K., Strickland, T. C., Feyereisen, G. W. and Sullivan, D. G.: Little river experimental watershed database, Water Resources Research, 43(9), doi:<a href="https://doi.org/10.1029/2006wr005844">10.1029/2006wr005844</a>, 2007.</p>
</div>
<div id="ref-Carnell2019">
<p>Carnell, R.: Lhs: Latin hypercube samples. [online] Available from: <a href="https://CRAN.R-project.org/package=lhs" class="uri">https://CRAN.R-project.org/package=lhs</a> (Accessed 5 March 2019), 2019.</p>
</div>
<div id="ref-Dutang2018">
<p>Dutang C. and P., S.: Randtoolbox: Generating and testing random numbers. [online] Available from: <a href="https://CRAN.R-project.org/package=randtoolbox" class="uri">https://CRAN.R-project.org/package=randtoolbox</a> (Accessed 5 March 2019), 2018.</p>
</div>
<div id="ref-MZB2017">
<p>Mauricio Zambrano-Bigiarini: HydroGOF: Goodness-of-fit functions for comparison of simulated and observed hydrological time series., 2017.</p>
</div>
<div id="ref-Mueller2019">
<p>Müller, K. and Wickham, H.: Tibble: Simple data frames. [online] Available from: <a href="https://CRAN.R-project.org/package=tibble" class="uri">https://CRAN.R-project.org/package=tibble</a> (Accessed 5 March 2019), 2019.</p>
</div>
<div id="ref-Nash1970">
<p>Nash, J. E. and Sutcliffe, J. V.: River flow forecasting through conceptual models part I - A discussion of principles, Journal of Hydrology, 10(3), 282–290, doi:<a href="https://doi.org/10.1016/0022-1694(70)90255-6">10.1016/0022-1694(70)90255-6</a>, 1970.</p>
</div>
<div id="ref-Rcore2019">
<p>R Core Team: R: A language and environment for statistical computing., [online] Available from: <a href="https://www.r-project.org/" class="uri">https://www.r-project.org/</a> (Accessed 5 March 2019), 2019.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#r-packages">R packages</a></li>
      <li><a href="#loading-demo-data">Loading demo data</a></li>
      <li><a href="#parameter-sampling">Parameter sampling</a></li>
      <li><a href="#model-calibration">Model calibration</a></li>
      <li><a href="#model-validation">Model validation</a></li>
      <li><a href="#visualization-of-discharge-simulation">Visualization of discharge simulation</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Christoph Schuerz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
